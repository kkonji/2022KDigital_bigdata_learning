cor(cats$Bwt, cats$Hwt, method='pearson')
cor(cats$Bwt, cats$Hwt, method='spearman')
# 12ì¥
library(MASS)
cor(cats$Bwt, cats$Hwt)
cor(cats$Bwt, cats$Hwt, method='pearson')
cor(cats$Bwt, cats$Hwt, method='spearman')
cor(cats$Bwt, cats$Hwt, method='kendall')
# ìƒê´€ê³„ìˆ˜ì— ëŒ€í•œ ìœ ì˜ì„± ê²€ì¦
cor.test(cats$Bwt, cats$Hwt)
cor.test(~Bwt + Hwt, data=cats)
cor.test(~Bwt + Hwt, data=cats, subset=(Sex=='F'))
cor.test
# 3ê°œ ì´ìƒì˜ ë³€ìˆ˜ê°„ì˜ ìƒê´€ê³„ìˆ˜ ìœ ì˜ì„± ê²€ì •
library(psych)
corr.test(iris[,-5])
library(corrgram)
corrgram(state.x77, lower.panel = panel.pie, order=T, upper.panel = panel.conf)
corr.test(iris[,-5], short=F)
print(corr.test(iris[,-5]), short=F)
library(corrgram)
corrgram(state.x77, lower.panel = panel.pie, order=T, upper.panel = panel.conf)
# ìƒê´€ê´€ê³„ ë„í‘œ
library(psych)
pairs.panels(state.x77, bg='red', pch=21, hist.col='gold', main='correlation')
corrgram(state.x77, lower.panel = panel.pie, order=T, upper.panel = panel.conf)
# í¸ìƒê´€ê³„ìˆ˜ : ë‘ ë³€ìˆ˜ê°„ì˜ ìˆœìˆ˜í•œ ìƒê´€ê´€ê³„ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•œ ì§€í‘œ
colnames(mtcars)
mtcars2 <- mtcars[,c('mpg', 'cyl', 'hp', 'wt')]
cor(mtcars2)
pcor(c(1,3,2,4), cov(mtcars2))
# ì—°ë¹„ì™€ ë§ˆë ¥ ê°„ì˜ í¸ìƒê´€ê³„ìˆ˜ êµ¬í•˜ê¸°
library(ggm)
pcor(c(1,3,2,4), cov(mtcars2))
# pcor (ë²¡í„°, ê³µë¶„ì‚°í–‰ë ¬)
# ë²¡í„°ì˜ ì²« ë‘ ì¸ë±ìŠ¤ëŠ” í¸ìƒê´€ê³„ìˆ˜ë¥¼ ê³„ì‚°í•  ë³€ìˆ˜, ë‚˜ë¨¸ì§€ëŠ” í†µì œí•  ë³€ìˆ˜
# ê³µë¶„ì‚°í–‰ë ¬ì€ covë¡œ ê³„ì‚°
pcor(c(1,3,2,4), cov(mtcars2))
pcor.test(pcor(c(1,3,2,4), cov(mtcars2)), q=2, n=nrow(mtcars2))
library(ppcor)
library(ppcor)
# p-valueëŠ” 0.14ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ì§€ ëª»í•œë‹¤. ê·¸ëŸ¬ë¯€ë¡œ
# mpgì™€ hpê°„ì—ëŠ” ìˆœìˆ˜í•œ ìƒê´€ê´€ê³„ëŠ” ì¡´ì¬x
install.packages(ppcor)
# p-valueëŠ” 0.14ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ì§€ ëª»í•œë‹¤. ê·¸ëŸ¬ë¯€ë¡œ
# mpgì™€ hpê°„ì—ëŠ” ìˆœìˆ˜í•œ ìƒê´€ê´€ê³„ëŠ” ì¡´ì¬x
install.packages('ppcor')
library(ppcor)
pcor.test(mtcars2['mpg'], mtcars2['hp'], mtcars2[c('cyl', 'wt')])
library(car)
str(Prestige)
df <- Prestige
table(df$type)
model <-lm(income ~ education, data=df)
model2 <-lm(income ~ women, data=df)
model3 <-lm(income ~ prestige, data=df)
summary(model)
par(mfrow=c(1,3))
plot(income~education, data=df, col='tomato', pch='ğŸ…')
abline(model, col='skyblue', lwd=2)
plot(income~women, data=df, col='orange', pch='ğŸ£')
abline(model2, col='skyblue', lwd=2)
plot(income~prestige, data=df, col='green', pch='ğŸ')
abline(model3, col='skyblue', lwd=2)
par(mfrow=c(1,1))
# ì‹ ë¢°êµ¬ê°„ ë°˜í™˜
confint(model)
# íšŒê·€ê³„ìˆ˜ ë°˜í™˜
coef(model)
anova(model)
summary(resid(model))
summary(resid(model))
summary(model)
# ì˜ˆì¸¡ê°’ ë°˜í™˜
fitted(model)
# predict í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ì˜ˆì¸¡
# ìƒˆë¡œìš´ ë°ì´í„° newdata ë„£ê¸°
prestige.new <- data.frame(education=c(5,10,15))
# ì˜ˆì¸¡
predict(model, newdata=prestige.new)
# interval= 95%ì‹ ë¢°êµ¬ê°„ ì¶œë ¥
predict(model, newdata=prestige.new, interval = 'confidence')
lm(income ~ education, data=Prestige, subset = (education > mean(education)))
lm(income ~ education, data=Prestige, subset = (education <= mean(education)))
# ë‹¤í•­íšŒê·€ë¶„ì„: ë‹¨ìˆœíšŒê·€ë¶„ì„ì´ 1ì°¨í•­ì— ëŒ€í•´ì„œë§Œ í–ˆë‹¤ë©´, ë‹¤í•­íšŒê·€ë¶„ì„ì€ 2ì°¨ ì´ìƒì˜ í•­ì„ ê°€ì§„ ë‹¤í•­í•¨ìˆ˜ì— í”¼íŒ…ì‹œí‚¤ëŠ” íšŒê·€ë°©ë²•
model <- lm(income ~ education + I(education^2), data=Prestige)
summary(model)
plot(Prestige$income~Prestige$education, pch=19, col='darkorange', xlab='education', ylab='income', main= 'Education and income')
plot(Prestige$income~Prestige$education, pch=19, col='darkorange', xlab='education', ylab='income', main= 'Education and income')
plot(Prestige$income~Prestige$education, pch=19, col='darkorange', xlab='education', ylab='income', main= 'Education and income')
library(dplyr)
lines(arrange(data.frame(Prestige$education), fitted(model)), Prestige$education, col='cornflowerblue', lwd=2)
# ë‹¤í•­íšŒê·€ë¶„ì„: ë‹¨ìˆœíšŒê·€ë¶„ì„ì´ 1ì°¨í•­ì— ëŒ€í•´ì„œë§Œ í–ˆë‹¤ë©´, ë‹¤í•­íšŒê·€ë¶„ì„ì€ 2ì°¨ ì´ìƒì˜ í•­ì„ ê°€ì§„ ë‹¤í•­í•¨ìˆ˜ì— í”¼íŒ…ì‹œí‚¤ëŠ” íšŒê·€ë°©ë²•
model <- lm(income ~ education + I(education^2), data=Prestige)
summary(model)
plot(Prestige$income~Prestige$education, pch=19, col='darkorange', xlab='education', ylab='income', main= 'Education and income')
library(dplyr)
lines(arrange(data.frame(Prestige$education), fitted(model)), Prestige$education, col='cornflowerblue', lwd=2)
lines(arrange(data.frame(Prestige$education, fitted(model)), Prestige$education ), col='cornflowerblue', lwd=2)
# í‘¸ì•„ì†¡ íšŒê·€ë¶„ì„ : ê²°ê³¼ë³€ìˆ˜ê°€ íŠ¹ì • ê¸°ê°„ ì´ë‚´ì˜ ì‚¬ê±´ë°œìƒíšŸìˆ˜ì¸ ê²½ìš°ì— ì ìš©
library(robust)
data("breslow.dat")
str(breslow.dat)
seizure <- breslow.dat[c('Base', 'Age', 'Trt', 'sumY')]
summary(seizure)
hist(seizure$sumY, breaks=20)
# ì¢…ì†ë³€ìˆ˜ê°€ íšŸìˆ˜ì´ê¸° ë•Œë¬¸ì— í‘¸ì•„ì†¡ ë¶„í¬ë¥¼ ì‚¬ìš©
model <- glm(sumY~ Base + Age + Trt, data=seizure, family=poisson)
summary(model)
# ggplot ë³µìŠµ
?ggplot
# ggplot ë³µìŠµ
library(ggplot2)
?ggplot
letters[1:3]
df
df <- data.frame(
gp = factor(rep(letters[1:3], each = 10)),
y = rnorm(30)
)
df
ds <- do.call(rbind, lapply(split(df, df$gp), function(d) {
data.frame(mean = mean(d$y), sd = sd(d$y), gp = d$gp)
}))
ds
# ggplot test 1
ggplot(df, aes(gp, y)) +
geom_point() +
geom_point(data = ds, aes(y = mean), colour = 'red', size = 3)
# ggplot test 1
ggplot(df, aes(gp, y)) +
geom_point() # +
ggplot() +
geom_point(data = df, aes(gp, y)) +
geom_point(data = ds, aes(gp, mean), colour = 'red', size = 3) +
geom_errorbar(
data = ds,
aes(gp, mean, ymin = mean - sd, ymax = mean + sd),
colour = 'red',
width = 0.4)
?aes
